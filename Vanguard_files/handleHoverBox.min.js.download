(function(){var o=ps.declarePackage("ps.hoverInfoBox.components");
o.handleHovers=f;
var i={top:$(window).scrollTop(),bottom:$(window).scrollTop()+$(window).height(),left:$(window).scrollLeft(),right:$(window).scrollLeft()+$(window).width()};
$(function(){$("ul.infoBoxesList > li").each(function(){var u=$(this);
var t=u.attr("boxId");
var v=u.attr("direction");
var p=typeof u.attr("bindTo")==="undefined"?"":u.attr("bindTo");
var s=u.html();
var q=typeof u.attr("class")==="undefined"?"":u.attr("class");
var r="<div id='"+t+"' class='"+q+"'><div class='infoWrapper "+v+"HoverWrapper' data-bindto='"+p+"'>"+s+"<div class='infoPointer'></div></div></div>";
$(".main").append(r)
});
f();
$(".hoverLink").each(function(){k(this)
});
$(window).scroll(function(){j()
})
});
function j(){i.top=$(window).scrollTop();
i.bottom=$(window).scrollTop()+$(window).height();
i.left=$(window).scrollLeft();
i.right=$(window).scrollLeft()+$(window).width()
}var n=false;
var a=false;
var g=false;
function e(){return((navigator.userAgent.indexOf("iPad")>0)||(navigator.userAgent.indexOf("iPhone")>0)||(navigator.userAgent.indexOf("iPod")>0)||(navigator.userAgent.indexOf("Android")>0))
}function k(s){var u=0,q=0,p=null,w=null;
var r=$("#"+$(s).attr("data-hoverBoxId")).children(".infoWrapper");
var t=r.attr("data-bindTo");
p=r.children(".infoPointer");
if(r.hasClass("centeredTopHoverWrapper")){w=$(s)
}else{var v=$(s).css("float");
$("<a class='dummyLink' style='float: "+v+";'>i</a>").insertBefore($(s));
w=$(".dummyLink")
}if(r.attr("data-bindTo")!==""&&$("#"+t).length>0){w=$("#"+t)
}if(r.hasClass("leftHoverWrapper")){u=w.offset().top+w.outerHeight()/2-r.outerHeight()/2;
q=w.offset().left-r.outerWidth()-p.outerWidth();
p.css({top:r.outerHeight()/2-p.outerHeight()/2})
}else{if(r.hasClass("topLeftHoverWrapper")){u=w.offset().top-r.outerHeight()-10;
q=w.offset().left-r.outerWidth()+52
}else{if(r.hasClass("centeredTopHoverWrapper")){u=w.offset().top-r.outerHeight()-13;
q=w.offset().left+w.width()/2-27
}else{u=Math.max(w.offset().top,$(s).offset().top)-r.outerHeight()-10;
if($(s).height()>parseInt($(s).css("line-height"),10)){q=w.offset().left
}else{q=Math.min(w.offset().left,$(s).offset().left)
}}}}$(".dummyLink").remove();
r.css({top:u+"px",left:q+"px"});
if(r.parent().hasClass("flipping")){h(r,$(s))
}}function m(q){var p=q.offset();
p.bottom=p.top+q.outerHeight();
p.right=p.left+q.outerWidth();
return(!(i.bottom<p.top||i.top>p.bottom))
}function c(p){return(p.offset().top<i.top)
}function d(p){return(p.offset().top+p.outerHeight()>i.bottom)
}function l(p){return(p.offset().left<i.left)
}function b(p){return(p.offset().left+p.outerWidth()>i.right)
}function h(s,p){s.addClass("block");
if(c(s)&&!d(s)){var q=s.offset().top+19+s.outerHeight()-23+s.find(".infoPointer").outerHeight()*2+p.outerHeight();
if(q+s.outerHeight()<i.bottom){s.css({top:q+"px"});
s.find(".infoPointer").css({bottom:s.outerHeight()-3}).addClass("infoPointerUp")
}}else{s.find(".infoPointer").css({bottom:"-13px"}).removeClass("infoPointerUp")
}if(b(s)&&!l(s)){var r=s.offset().left-s.outerWidth()+52;
if(r>i.left){s.css({left:r+"px"});
s.find(".infoPointer").css({left:s.outerWidth()-52})
}}else{s.find(".infoPointer").css({left:9})
}s.removeClass("block")
}function f(){if(e()){$(".hoverLink").unbind("touchstart");
$(document).on("touchstart",".hoverLink",function(s){s.stopPropagation();
k(this);
$(".openHover").removeClass("openHover");
q($(this));
$(document).unbind("touchstart.hoverBoxUnbind");
$(document).bind("touchstart.hoverBoxUnbind",function(t){$(".openHover").removeClass("openHover");
$(document).unbind("touchstart.hoverBoxUnbind")
})
});
$(document).on("touchstart",".hoverLink",function(t){var s=$(this).attr("href");
if(typeof s!=="undefined"&&s!="javascript:void(0);"){window.location=s
}})
}else{$(document).off(".hoverbox");
$(document).on("mouseenter.hoxerbox",".hoverLink",p);
$(document).on("mouseleave.hoxerbox",".hoverLink",function(){n=false;
r()
})
}$(".infoWrapper").off("click.hoverbox");
$(".infoWrapper").on("click.hoxerbox",function(s){s.stopPropagation()
});
$(".hoverLink").off("click.hoverbox");
$(".hoverLink").on("click.hoxerbox",function(s){s.stopPropagation()
});
$(document).off(".hoverbox");
$(document).on("mouseenter.hoxerbox",".infoWrapper",function(){a=true
});
$(document).on("mouseleave.hoxerbox",".infoWrapper",function(){a=false;
r()
});
$(document).on("mouseenter.hoxerbox",".infoPointer",function(){g=true
});
$(document).on("mouseleave.hoxerbox",".infoPointer",function(){g=false;
r()
});
function p(){n=true;
$(".openHover").removeClass("openHover");
k(this);
q($(this))
}function q(s){$("#"+s.attr("data-hoverBoxId")).children(".infoWrapper").addClass("openHover");
$("[data-hoverBoxId="+s.attr("data-hoverBoxId")+"]").addClass("openHover")
}function r(){setTimeout(function(){if(!a&&!n&&!g){$(".openHover").removeClass("openHover")
}},100)
}}$(document).on("afterupdate","*[data-source]",function(){f()
})
})();